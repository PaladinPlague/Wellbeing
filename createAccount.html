<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create Account</title>
</head>
<body>
<h1>Create an Account</h1>

<!-- discuss what data we want to store in database (or just uname/pword) test comment ALSO CHECK FOR UNIQUE USERNAME-->
<form id="createAccountForm" action="#" method="POST">

    <p>
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" placeholder="Enter Username">
    </p>

    <p>
        <label for="password">Password:</label>
        <input type="password" id="password" name="password" placeholder="Enter Password">
    </p>

<!--    <p>
        <label for="rpassword">Repeat Password:</label>
        <input type="password" id="rpassword" name="rpassword" placeholder="Repeat Password" required>
    </p>-->

    <p>
        <a href="login.html" title="Login">Return to Login</a>
    </p>

    <p>
        <input type="submit" value="Sign Up" class="submit_button">
    </p>

</form>

<p id="output"></p>

<div id="tempNavBox">
    <a href="login.html">Login Page</a><br/>
</div>
</body>
<script>
    function doAJAXPOST(functionToRun, formData){
        // Initialize the HTTP request.
        let xhr = new XMLHttpRequest();
        xhr.open('POST', 'create_account.php');

        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) { // 4 means the request is finished, 200 means the request was successful
                //execute the given function once the response is received
                functionToRun(xhr.responseText);
            }
        }

        // Send the request

        xhr.send(formData);
    }

    document.getElementById("createAccountForm").addEventListener("submit",

        function(evt) {
            evt.preventDefault();
            document.getElementById("output").innerHTML = "Logging in..."

            let formData = new FormData();
            formData.append("username", document.getElementById("username").value);
            formData.append("password", document.getElementById("password").value);

            function showResult(text) {
                if(text === "1") {
                    document.getElementById("output").innerHTML = "Success!";
                    setTimeout(function() {window.location.href = "login.html"}, 1000);
                } else {
                    document.getElementById("output").innerHTML = "Failed.";
                }

            }

            doAJAXPOST(showResult, formData);
        }

    );


</script>
</html>